<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SyntheticPolygons | 3D Art & Game Dev Studio</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Rajdhani:wght@500;600;700&display=swap" rel="stylesheet">
    
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <style>
        :root {
            --bg-dark: #050505;
            --bg-panel: #0a0a0a;
            --neon-cyan: #00f3ff;
            --neon-purple: #bc13fe;
            --text-main: #e0e0e0;
            --text-muted: #888888;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            line-height: 1.6;
        }

        h1, h2, h3, h4 {
            font-family: 'Rajdhani', sans-serif;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        a { text-decoration: none; color: inherit; }

        /* --- UI UTILITIES --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .neon-text-cyan { color: var(--neon-cyan); text-shadow: 0 0 10px rgba(0, 243, 255, 0.5); }
        .neon-text-purple { color: var(--neon-purple); text-shadow: 0 0 10px rgba(188, 19, 254, 0.5); }

        .btn {
            display: inline-block; padding: 12px 30px;
            font-family: 'Rajdhani', sans-serif; font-weight: 700; font-size: 1.1rem;
            text-transform: uppercase; border: 1px solid var(--neon-cyan);
            color: var(--neon-cyan); background: transparent; cursor: pointer;
            transition: all 0.3s ease; position: relative; overflow: hidden;
        }
        .btn:hover {
            background: rgba(0, 243, 255, 0.1);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.4);
            letter-spacing: 2px;
        }

        /* --- HEADER --- */
        header {
            padding: 20px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(5, 5, 5, 0.8); backdrop-filter: blur(10px);
            position: fixed; width: 100%; z-index: 1000; top: 0;
        }
        .nav-flex { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: 700; color: white; }

        /* --- HERO SECTION --- */
        #hero {
            height: 90vh; display: flex; align-items: center; justify-content: center;
            text-align: center; background: radial-gradient(circle at center, #1a1a1a 0%, #050505 70%);
            position: relative; padding-top: 60px;
        }
        .hero-content h1 { font-size: 4rem; margin-bottom: 20px; line-height: 1.1; }
        .hero-content p {
            font-size: 1.2rem; color: var(--text-muted); margin-bottom: 40px;
            max-width: 600px; margin-left: auto; margin-right: auto;
        }

        /* --- 3D VIEWER SECTION --- */
        #portfolio-viewer {
            padding: 80px 0; background: #080808;
            border-top: 1px solid #222; border-bottom: 1px solid #222;
        }
        .viewer-container {
            position: relative; width: 100%; height: 600px;
            background: #000; border: 1px solid #333; border-radius: 4px;
            overflow: hidden; box-shadow: 0 0 30px rgba(0,0,0,0.8);
        }
        #canvas-container { width: 100%; height: 100%; }

        /* --- VIEWER UI CONTROLS --- */
        .viewer-ui {
            position: absolute; bottom: 20px; left: 50%;
            transform: translateX(-50%); display: flex; gap: 20px; align-items: center;
            background: rgba(0, 0, 0, 0.7); padding: 10px 20px;
            border-radius: 30px; border: 1px solid #333; backdrop-filter: blur(5px);
            z-index: 10;
        }
        .viewer-btn {
            background: none; border: 1px solid var(--neon-purple); color: var(--neon-purple);
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer;
            font-weight: bold; transition: 0.2s; display: flex; align-items: center; justify-content: center;
        }
        .viewer-btn:hover { background: var(--neon-purple); color: black; box-shadow: 0 0 15px var(--neon-purple); }
        #model-label { color: white; font-family: 'Rajdhani', sans-serif; font-size: 1.2rem; min-width: 200px; text-align: center; }

        /* --- NEW SETTINGS PANEL --- */
        .controls-panel {
            position: absolute; top: 20px; right: 20px;
            width: 250px; background: rgba(0, 0, 0, 0.85);
            border: 1px solid var(--neon-cyan); padding: 20px;
            border-radius: 8px; backdrop-filter: blur(5px);
            z-index: 10;
        }
        .control-group { margin-bottom: 15px; }
        .control-group label {
            display: block; color: var(--neon-cyan); font-size: 0.8rem;
            font-family: 'Rajdhani', sans-serif; margin-bottom: 5px; text-transform: uppercase;
        }
        .control-group input[type="range"] {
            width: 100%; cursor: pointer; accent-color: var(--neon-purple);
        }
        .toggle-btn {
            width: 100%; padding: 8px; background: transparent;
            border: 1px solid var(--neon-purple); color: white;
            font-family: 'Rajdhani', sans-serif; cursor: pointer;
            transition: 0.3s; text-transform: uppercase; font-size: 0.9rem;
        }
        .toggle-btn.active {
            background: var(--neon-purple); color: black;
            box-shadow: 0 0 10px var(--neon-purple);
        }

        .loading-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); display: flex; justify-content: center;
            align-items: center; color: var(--neon-cyan);
            font-family: 'Rajdhani', sans-serif; font-size: 1.5rem;
            pointer-events: none; opacity: 0; transition: opacity 0.3s; z-index: 20;
        }
        .loading-overlay.active { opacity: 1; }

        /* --- SERVICES GRID --- */
        #services { padding: 100px 0; }
        .section-header { text-align: center; margin-bottom: 60px; }
        .section-header h2 { font-size: 2.5rem; margin-bottom: 10px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; }
        .card {
            background: var(--bg-panel); padding: 30px; border: 1px solid #222;
            transition: 0.3s; position: relative; overflow: hidden;
        }
        .card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-purple));
            transform: scaleX(0); transform-origin: left; transition: transform 0.4s ease;
        }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,0,0,0.5); border-color: #333; }
        .card:hover::before { transform: scaleX(1); }
        .card h3 { font-size: 1.5rem; margin-bottom: 15px; color: white; }
        .card p { color: var(--text-muted); font-size: 0.95rem; }

        /* --- FOOTER --- */
        footer { padding: 40px 0; border-top: 1px solid #222; text-align: center; color: var(--text-muted); font-size: 0.9rem; }

        @media (max-width: 768px) {
            .hero-content h1 { font-size: 2.5rem; }
            .viewer-container { height: 400px; }
            .controls-panel { position: relative; top: 0; right: 0; width: 100%; margin-bottom: 10px; border: none; border-bottom: 1px solid #333; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container nav-flex">
            <div class="logo">SYNTHETIC<span class="neon-text-cyan">POLYGONS</span></div>
            <a href="#contact" class="btn" style="padding: 8px 20px; font-size: 0.9rem;">Contact</a>
        </div>
    </header>

    <section id="hero">
        <div class="container hero-content">
            <h1>BRINGING WORLDS<br><span class="neon-text-purple">TO LIFE</span></h1>
            <p>Premium 3D outsourcing for AA/AAA game development. We specialize in optimized assets, rigging, and level design.</p>
            <button class="btn">Get a Quote</button>
        </div>
    </section>

    <section id="portfolio-viewer">
        <div class="container">
            <div class="section-header">
                <h2>Asset <span class="neon-text-cyan">Viewer</span></h2>
                <p style="color: var(--text-muted)">Inspect our latest topology and texture work in real-time.</p>
            </div>

            <div class="viewer-container">
                <div id="canvas-container"></div>
                
                <div id="loader" class="loading-overlay">
                    LOADING ASSET...
                </div>

                <div class="controls-panel">
                    <div class="control-group">
                        <label>Light Angle</label>
                        <input type="range" id="light-angle" min="0" max="6.28" step="0.1" value="1">
                    </div>
                    <div class="control-group">
                        <label>Light Intensity</label>
                        <input type="range" id="light-intensity" min="0" max="5" step="0.1" value="2">
                    </div>
                    <button id="wireframe-btn" class="toggle-btn">Toggle Wireframe</button>
                </div>

                <div class="viewer-ui">
                    <button class="viewer-btn" id="prev-btn">&lt;</button>
                    <div id="model-label">Initialize Viewer</div>
                    <button class="viewer-btn" id="next-btn">&gt;</button>
                </div>
            </div>
        </div>
    </section>

    <section id="services">
        <div class="container">
            <div class="section-header">
                <h2>Our <span class="neon-text-purple">Services</span></h2>
            </div>
            <div class="grid">
                <div class="card">
                    <h3>Character Modeling</h3>
                    <p>High-fidelity sculpting, retopology, and PBR texturing for hero characters and NPCs.</p>
                </div>
                <div class="card">
                    <h3>Environment Design</h3>
                    <p>Modular assets, props, and terrain creation optimized for Unity and Unreal Engine.</p>
                </div>
                <div class="card">
                    <h3>Rigging & Animation</h3>
                    <p>Production-ready skeletal rigs with proper weight painting and facial blendshapes.</p>
                </div>
                <div class="card">
                    <h3>Level Design</h3>
                    <p>Greyboxing, lighting, and composition to guide player flow and narrative.</p>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2026 SyntheticPolygons. All Rights Reserved.</p>
            <p style="margin-top: 10px;">contact@syntheticpolygons.dev</p>
        </div>
    </footer>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

        // ==========================================
        // CONFIGURATION
        // ==========================================
        const modelFiles = [
            "Car1.glb", 
            "Car2.glb",
            "Car3.glb"
        ];
        
        // State
        let currentIndex = 0;
        let scene, camera, renderer, controls, loader;
        let currentModel = null;
        let dirLight = null; // We need global access to this light
        let isWireframeOn = false;

        // UI Elements
        const container = document.getElementById('canvas-container');
        const label = document.getElementById('model-label');
        const loadingOverlay = document.getElementById('loader');
        const angleSlider = document.getElementById('light-angle');
        const intensitySlider = document.getElementById('light-intensity');
        const wireframeBtn = document.getElementById('wireframe-btn');

        init();
        animate();

        // Load Initial Model
        if(modelFiles.length > 0) {
            loadModel(currentIndex);
        } else {
            loadFallback("No Models Configured");
        }

        function init() {
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x111111);
            
            // Grid
            const gridHelper = new THREE.GridHelper(10, 20, 0x00f3ff, 0x333333);
            scene.add(gridHelper);

            // Camera
            camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 100);
            camera.position.set(3, 2, 5);

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1;
            container.appendChild(renderer.domElement);

            // --- LIGHTING SETUP ---
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
            scene.add(ambientLight);
            
            // Directional Light (The one we will control)
            dirLight = new THREE.DirectionalLight(0xffffff, 2);
            dirLight.position.set(5, 5, 5);
            dirLight.castShadow = true;
            scene.add(dirLight);

            // Accent Light (Neon Purple)
            const neonLight = new THREE.PointLight(0xbc13fe, 2, 10);
            neonLight.position.set(-2, 3, -2);
            scene.add(neonLight);

            // Controls
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;

            // Loader
            loader = new GLTFLoader();

            // Resize Handler
            window.addEventListener('resize', onWindowResize);

            // --- UI EVENT LISTENERS ---
            
            // Model Navigation
            document.getElementById('prev-btn').addEventListener('click', () => {
                currentIndex = (currentIndex > 0) ? currentIndex - 1 : modelFiles.length - 1;
                loadModel(currentIndex);
            });
            document.getElementById('next-btn').addEventListener('click', () => {
                currentIndex = (currentIndex < modelFiles.length - 1) ? currentIndex + 1 : 0;
                loadModel(currentIndex);
            });

            // Lighting Controls
            angleSlider.addEventListener('input', updateLight);
            intensitySlider.addEventListener('input', updateLight);

            // Wireframe Toggle
            wireframeBtn.addEventListener('click', () => {
                isWireframeOn = !isWireframeOn;
                toggleWireframe(isWireframeOn);
                
                // Update Button Style
                if(isWireframeOn) wireframeBtn.classList.add('active');
                else wireframeBtn.classList.remove('active');
            });
        }

        // --- NEW FUNCTION: Update Light based on Sliders ---
        function updateLight() {
            if(!dirLight) return;
            
            // Intensity
            dirLight.intensity = parseFloat(intensitySlider.value);

            // Angle (Rotate around Y axis)
            const angle = parseFloat(angleSlider.value);
            const radius = 8; // Distance from center
            dirLight.position.x = Math.sin(angle) * radius;
            dirLight.position.z = Math.cos(angle) * radius;
            // Keep Y height constant
            dirLight.position.y = 5; 
        }

        // --- NEW FUNCTION: Toggle Wireframe Overlay ---
        function toggleWireframe(enable) {
            if (!currentModel) return;

            if (enable) {
                // Add Wireframe
                currentModel.traverse((child) => {
                    if (child.isMesh && child.name !== 'wireframe-overlay') {
                        // Create a wireframe version
                        const wireframeGeometry = new THREE.WireframeGeometry(child.geometry);
                        const wireframeMaterial = new THREE.LineBasicMaterial({ 
                            color: 0x00f3ff, // Neon Cyan
                            transparent: true,
                            opacity: 0.4
                        });
                        
                        const wireframe = new THREE.LineSegments(wireframeGeometry, wireframeMaterial);
                        wireframe.name = 'wireframe-overlay';
                        
                        // Slightly scale up to avoid z-fighting (glitching)
                        // Or utilize renderOrder/depthTest, but slight scale is reliable for basic view
                        wireframe.scale.setScalar(1.001); 
                        
                        child.add(wireframe);
                    }
                });
            } else {
                // Remove Wireframe
                currentModel.traverse((child) => {
                    if (child.isMesh) {
                        // Find the wireframe child and remove it
                        const wireframe = child.getObjectByName('wireframe-overlay');
                        if (wireframe) {
                            child.remove(wireframe);
                            wireframe.geometry.dispose();
                            wireframe.material.dispose();
                        }
                    }
                });
            }
        }

        function loadModel(index) {
            const filename = modelFiles[index];
            const path = `./models/${filename}`;
            
            label.textContent = filename.replace(/_/g, ' ').replace('.glb', '').toUpperCase();
            loadingOverlay.classList.add('active');

            // Remove previous model
            if (currentModel) {
                scene.remove(currentModel);
                currentModel = null;
                // Reset wireframe state visually for new model
                isWireframeOn = false;
                wireframeBtn.classList.remove('active');
            }

            loader.load(
                path,
                (gltf) => {
                    currentModel = gltf.scene;
                    
                    // Auto-center and scale
                    const box = new THREE.Box3().setFromObject(currentModel);
                    const center = box.getCenter(new THREE.Vector3());
                    const size = box.getSize(new THREE.Vector3());
                    
                    // Center model
                    currentModel.position.x += (currentModel.position.x - center.x);
                    currentModel.position.y += (currentModel.position.y - center.y);
                    currentModel.position.z += (currentModel.position.z - center.z);
                    
                    // Lift it slightly above grid
                    currentModel.position.y += size.y / 2;

                    scene.add(currentModel);
                    loadingOverlay.classList.remove('active');
                },
                undefined,
                (error) => {
                    console.error('An error happened loading the GLB:', error);
                    loadFallback("File Not Found / Load Error");
                }
            );
        }

        function loadFallback(message) {
            loadingOverlay.classList.remove('active');
            label.textContent = message;
            if (currentModel) scene.remove(currentModel);

            // Placeholder Torus
            const geometry = new THREE.TorusKnotGeometry(1, 0.3, 100, 16);
            const material = new THREE.MeshStandardMaterial({ 
                color: 0x00f3ff, 
                wireframe: true,
                emissive: 0x00f3ff,
                emissiveIntensity: 0.5
            });
            currentModel = new THREE.Mesh(geometry, material);
            currentModel.position.y = 1.5;
            scene.add(currentModel);
        }

        function onWindowResize() {
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
    </script>
</body>
</html>